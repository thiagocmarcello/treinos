<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="../tamplate/template.xhtml">
	<ui:define name="content">
		<h:form id="aparelhoFO">
			<p:tabView id="aparelhoTV" activeIndex="#{treinoController.indexTab}"
				styleClass="sem-bordas">
				<p:tab title="Cadastrar">
					<h:panelGrid columns="2">

						<h:outputLabel value="Nome: " />
						<h:inputText id="nomeTreino"
							value="#{treinoController.treino.nome}" />

						<h:outputText value="Metodologia:" />
						<p:selectOneMenu id="metodologiaSOM"
							value="#{treinoController.metodologiaSelecionada}"
							converter="converterMetodologia">
							<f:selectItem itemLabel="SELECIONE..." itemValue="0" />
							<f:selectItems value="#{treinoController.metodologias}" var="o"
								itemValue="#{o}" itemLabel="#{o.nome}" />
							<p:ajax />
						</p:selectOneMenu>

						<h:outputText value="Aparelho:" />
						<p:selectOneMenu id="idTreino"
							value="#{treinoController.aparelhoSelecionado}"
							converter="converterAparelho">
							<f:selectItem itemLabel="SELECIONE..." itemValue="0" />
							<f:selectItems value="#{treinoController.aparelhos}" var="o"
								itemValue="#{o}" itemLabel="#{o.nome}" />
							<f:ajax />
						</p:selectOneMenu>

						<h:outputLabel value="Sequencia: " />
						<h:inputText id="sequencia"
							value="#{treinoController.exercicio.sequencia}">
							<f:ajax />
						</h:inputText>

						<h:outputLabel id="repeticao" value="Repetição: " />
						<h:inputText value="#{treinoController.exercicio.repeticao}">
							<f:ajax />
						</h:inputText>

						<p:commandButton action="#{treinoController.adicionarExercicio()}"
							value="Adicionar Aparelho" process="@this" update=":aparelhoFO">
						</p:commandButton>

						<p:dataList id="idListaAparelhos"
							value="#{treinoController.exercicios}"
							emptyMessage="Lista de Exercicios Vazia!" var="aparelho">
							<f:facet name="header">
      							Aparelhos:
        					</f:facet>
							<p:commandButton process="@this" icon="delete"
								action="#{treinoController.removerExercicio(aparelho)}"
								update=":aparelhoFO" />
        						#{aparelho.aparelho.nome}, #{aparelho.sequencia}x de #{aparelho.repeticao}
    					</p:dataList>
						<p:commandButton action="#{treinoController.salvar}"
							update=":aparelhoFO" value="Salvar" />
					</h:panelGrid>
				</p:tab>
				<!-- *** CONSULTAR *** -->
				<p:tab title="Consultar">
					<h:panelGrid>
						<p:dataTable id="tableTreino" value="#{treinoController.treinos}"
							var="p" rows="6" emptyMessage="sem registros" paginator="true">
							<p:column>
								<f:facet name="header">
									<h:outputText value="Nome" />
								</f:facet>
								<h:outputText value="#{p.nome}" />
							</p:column>
							<p:column filterBy="#{p.metodologia.nome}"
								sortBy="#{p.metodologia.nome}">
								<f:facet name="header">
									<h:outputText value="Metodologia" />
								</f:facet>
								<h:outputText value="#{p.metodologia.nome}" />
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="Exercicios" />
								</f:facet>
								<p:dataList value="#{p.exercicios}" var="exe">
													#{exe.aparelho.nome} #{exe.sequencia}x de #{exe.repeticao}
								</p:dataList>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="Ações" />
								</f:facet>
								<p:commandButton process="@this" icon="delete"
									action="#{treinoController.deletar(p)}"
									update=":aparelhoFO:aparelhoTV" title="Remover" />
								<p:commandButton process="@this" icon="editar"
									update=":aparelhoFO" action="#{treinoController.editar(p)}"
									title="Alterar" />
							</p:column>
						</p:dataTable>
					</h:panelGrid>
				</p:tab>
			</p:tabView>
		</h:form>
	</ui:define>
</ui:composition>
</html>